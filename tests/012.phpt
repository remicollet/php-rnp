--TEST--
list keys test
--EXTENSIONS--
rnp
--CAPTURE_STDIO--
STDIN STDOUT
--FILE--
<?php
require_once "testkeys.inc";

$ffi = rnp_ffi_create('GPG', 'GPG');

//empty FFI
var_dump(rnp_list_keys($ffi, "userid"));
var_dump(rnp_list_keys($ffi, "keyid"));
var_dump(rnp_list_keys($ffi, "fingerprint"));
var_dump(rnp_list_keys($ffi, "grip"));

var_dump(rnp_load_keys($ffi, 'GPG', $keyring1_pubring, RNP_LOAD_SAVE_PUBLIC_KEYS));

var_dump(rnp_list_keys($ffi, "userid"));
var_dump(rnp_list_keys($ffi, "keyid"));
var_dump(rnp_list_keys($ffi, "fingerprint"));
var_dump(rnp_list_keys($ffi, "grip"));

rnp_ffi_destroy($ffi);
?>
--EXPECTF--
array(0) {
}
array(0) {
}
array(0) {
}
array(0) {
}
bool(true)
array(6) {
  ["key0-uid0"]=>
  string(40) "E95A3CBF583AA80A2CCC53AA7BC6709B15C23A4A"
  ["key0-uid1"]=>
  string(40) "E95A3CBF583AA80A2CCC53AA7BC6709B15C23A4A"
  ["key0-uid2"]=>
  string(40) "E95A3CBF583AA80A2CCC53AA7BC6709B15C23A4A"
  ["key1-uid0"]=>
  string(40) "BE1C4AB951F4C2F6B604C7F82FCADF05FFA501BB"
  ["key1-uid2"]=>
  string(40) "BE1C4AB951F4C2F6B604C7F82FCADF05FFA501BB"
  ["key1-uid1"]=>
  string(40) "BE1C4AB951F4C2F6B604C7F82FCADF05FFA501BB"
}
array(7) {
  ["7BC6709B15C23A4A"]=>
  string(40) "E95A3CBF583AA80A2CCC53AA7BC6709B15C23A4A"
  ["1ED63EE56FADC34D"]=>
  string(40) "E332B27CAF4742A11BAA677F1ED63EE56FADC34D"
  ["1D7E8A5393C997A8"]=>
  string(40) "C5B15209940A7816A7AF3FB51D7E8A5393C997A8"
  ["8A05B89FAD5ADED1"]=>
  string(40) "5CD46D2A0BD0B8CFE0B130AE8A05B89FAD5ADED1"
  ["2FCADF05FFA501BB"]=>
  string(40) "BE1C4AB951F4C2F6B604C7F82FCADF05FFA501BB"
  ["54505A936A4A970E"]=>
  string(40) "A3E94DE61A8CB229413D348E54505A936A4A970E"
  ["326EF111425D14A5"]=>
  string(40) "57F8ED6E5C197DB63C60FFAF326EF111425D14A5"
}
array(7) {
  ["E95A3CBF583AA80A2CCC53AA7BC6709B15C23A4A"]=>
  string(40) "E95A3CBF583AA80A2CCC53AA7BC6709B15C23A4A"
  ["E332B27CAF4742A11BAA677F1ED63EE56FADC34D"]=>
  string(40) "E332B27CAF4742A11BAA677F1ED63EE56FADC34D"
  ["C5B15209940A7816A7AF3FB51D7E8A5393C997A8"]=>
  string(40) "C5B15209940A7816A7AF3FB51D7E8A5393C997A8"
  ["5CD46D2A0BD0B8CFE0B130AE8A05B89FAD5ADED1"]=>
  string(40) "5CD46D2A0BD0B8CFE0B130AE8A05B89FAD5ADED1"
  ["BE1C4AB951F4C2F6B604C7F82FCADF05FFA501BB"]=>
  string(40) "BE1C4AB951F4C2F6B604C7F82FCADF05FFA501BB"
  ["A3E94DE61A8CB229413D348E54505A936A4A970E"]=>
  string(40) "A3E94DE61A8CB229413D348E54505A936A4A970E"
  ["57F8ED6E5C197DB63C60FFAF326EF111425D14A5"]=>
  string(40) "57F8ED6E5C197DB63C60FFAF326EF111425D14A5"
}
array(7) {
  ["66D6A0800A3FACDE0C0EB60B16B3669ED380FDFA"]=>
  string(40) "E95A3CBF583AA80A2CCC53AA7BC6709B15C23A4A"
  ["D9839D61EDAF0B3974E0A4A341D6E95F3479B9B7"]=>
  string(40) "E332B27CAF4742A11BAA677F1ED63EE56FADC34D"
  ["B1CC352FEF9A6BD4E885B5351840EF9306D635F0"]=>
  string(40) "C5B15209940A7816A7AF3FB51D7E8A5393C997A8"
  ["E7C8860B70DC727BED6DB64C633683B41221BB40"]=>
  string(40) "5CD46D2A0BD0B8CFE0B130AE8A05B89FAD5ADED1"
  ["B2A7F6C34AA2C15484783E9380671869A977A187"]=>
  string(40) "BE1C4AB951F4C2F6B604C7F82FCADF05FFA501BB"
  ["43C01D6D96BE98C3C87FE0F175870ED92DE7BE45"]=>
  string(40) "A3E94DE61A8CB229413D348E54505A936A4A970E"
  ["8082FE753013923972632550838A5F13D81F43B9"]=>
  string(40) "57F8ED6E5C197DB63C60FFAF326EF111425D14A5"
}
